<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WorkSpace - ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</title>
    
    <!-- CSS íŒŒì¼ë“¤ ì„í¬íŠ¸ -->
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/page2.css">
</head>
<body>
    <!-- ë°°ê²½ ì¥ì‹ -->
    <div class="bg-decoration"></div>
    <div class="bg-decoration"></div>
    <div class="bg-decoration"></div>

    <div class="reset-container">
        <!-- í—¤ë” -->
        <div class="header-section">
            <div class="logo">ğŸ”‘</div>
            <h1 class="title">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</h1>
            <p class="subtitle">ê³„ì • ë³µêµ¬ë¥¼ ìœ„í•´ ë‹¨ê³„ë³„ë¡œ ì§„í–‰í•©ë‹ˆë‹¤</p>
        </div>

        <!-- ì§„í–‰ í‘œì‹œê¸° -->
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="step-indicators">
            <div class="step active" id="step1-indicator">
                <span>1ï¸âƒ£</span>
                <span>ì´ë©”ì¼ í™•ì¸</span>
            </div>
            <div class="step" id="step2-indicator">
                <span>2ï¸âƒ£</span>
                <span>ì¸ì¦ ì½”ë“œ</span>
            </div>
            <div class="step" id="step3-indicator">
                <span>3ï¸âƒ£</span>
                <span>ìƒˆ ë¹„ë°€ë²ˆí˜¸</span>
            </div>
        </div>

        <!-- 1ë‹¨ê³„: ì´ë©”ì¼ ì…ë ¥ -->
        <div class="step-container active" id="step1">
            <div class="form-group">
                <label class="form-label" for="reset-email">
                    ì´ë©”ì¼ ì£¼ì†Œ <span class="required">*</span>
                </label>
                <input 
                    type="email" 
                    id="reset-email" 
                    class="form-input" 
                    placeholder="name@company.com"
                    required
                >
                <div class="validation-message" id="email-error"></div>
            </div>

            <button class="btn btn-primary" onclick="sendResetCode()">
                <div class="loading-spinner" id="step1-spinner"></div>
                <span id="step1-text">ì¸ì¦ ì½”ë“œ ë³´ë‚´ê¸°</span>
            </button>
        </div>

        <!-- 2ë‹¨ê³„: ì¸ì¦ ì½”ë“œ ì…ë ¥ -->
        <div class="step-container" id="step2">
            <div class="info-box">
                <div class="info-icon">ğŸ“§</div>
                <div class="info-title">ì¸ì¦ ì½”ë“œë¥¼ ë³´ëƒˆìŠµë‹ˆë‹¤</div>
                <div class="info-email" id="sent-email-display"></div>
                <div class="info-text">
                    ìœ„ ì´ë©”ì¼ë¡œ 6ìë¦¬ ì¸ì¦ ì½”ë“œë¥¼ ë³´ëƒˆìŠµë‹ˆë‹¤.<br>
                    ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">ì¸ì¦ ì½”ë“œ</label>
                <div class="code-inputs">
                    <input type="text" class="code-input" maxlength="1" id="code1">
                    <input type="text" class="code-input" maxlength="1" id="code2">
                    <input type="text" class="code-input" maxlength="1" id="code3">
                    <input type="text" class="code-input" maxlength="1" id="code4">
                    <input type="text" class="code-input" maxlength="1" id="code5">
                    <input type="text" class="code-input" maxlength="1" id="code6">
                </div>
                <div class="validation-message" id="code-error"></div>
            </div>

            <button class="btn btn-primary" onclick="verifyCode()">
                <div class="loading-spinner" id="step2-spinner"></div>
                <span id="step2-text">ì¸ì¦ ì½”ë“œ í™•ì¸</span>
            </button>

            <button class="btn btn-secondary" onclick="resendCode()">
                <span id="resend-text">ì½”ë“œ ë‹¤ì‹œ ë³´ë‚´ê¸°</span>
            </button>
        </div>

        <!-- 3ë‹¨ê³„: ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì„¤ì • -->
        <div class="step-container" id="step3">
            <div class="success-box">
                <div class="success-icon">âœ…</div>
                <div class="success-title">ì¸ì¦ ì™„ë£Œ!</div>
                <div class="success-text">ì´ì œ ìƒˆë¡œìš´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•˜ì„¸ìš”.</div>
            </div>

            <div class="form-group">
                <label class="form-label" for="new-password">
                    ìƒˆ ë¹„ë°€ë²ˆí˜¸ <span class="required">*</span>
                </label>
                <input 
                    type="password" 
                    id="new-password" 
                    class="form-input" 
                    placeholder="8ì ì´ìƒì˜ ìƒˆ ë¹„ë°€ë²ˆí˜¸"
                    required
                >
                <div class="password-strength" id="password-strength">
                    <div class="strength-bar">
                        <div class="strength-fill" id="strength-fill"></div>
                    </div>
                    <div class="strength-text" id="strength-text"></div>
                </div>
                <div class="validation-message" id="password-error"></div>
            </div>

            <div class="form-group">
                <label class="form-label" for="confirm-password">
                    ë¹„ë°€ë²ˆí˜¸ í™•ì¸ <span class="required">*</span>
                </label>
                <input 
                    type="password" 
                    id="confirm-password" 
                    class="form-input" 
                    placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”"
                    required
                >
                <div class="validation-message" id="confirm-error"></div>
            </div>

            <button class="btn btn-primary" onclick="resetPassword()">
                <div class="loading-spinner" id="step3-spinner"></div>
                <span id="step3-text">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</span>
            </button>
        </div>

        <!-- ë¡œê·¸ì¸ ë§í¬ -->
        <div class="login-link">
            <a href="page1_login.html">ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 3;
        let userEmail = '';

        // 1ë‹¨ê³„: ì´ë©”ì¼ ì¸ì¦ ì½”ë“œ ë³´ë‚´ê¸°
        function sendResetCode() {
            const email = document.getElementById('reset-email').value;
            const emailError = document.getElementById('email-error');
            const spinner = document.getElementById('step1-spinner');
            const btnText = document.getElementById('step1-text');
            
            // ì´ë©”ì¼ ìœ íš¨ì„± ê²€ì‚¬
            if (!email || !email.includes('@')) {
                showError('email-error', 'ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë¡œë”© ìƒíƒœ
            spinner.style.display = 'inline-block';
            btnText.textContent = 'ì „ì†¡ ì¤‘...';

            // ê°€ì§œ API í˜¸ì¶œ
            setTimeout(() => {
                userEmail = email;
                document.getElementById('sent-email-display').textContent = email;
                
                nextStep();
                
                // ë²„íŠ¼ ì›ë³µ
                spinner.style.display = 'none';
                btnText.textContent = 'ì¸ì¦ ì½”ë“œ ë³´ë‚´ê¸°';
            }, 1500);
        }

        // 2ë‹¨ê³„: ì¸ì¦ ì½”ë“œ í™•ì¸
        function verifyCode() {
            const code = getEnteredCode();
            const spinner = document.getElementById('step2-spinner');
            const btnText = document.getElementById('step2-text');
            
            if (code.length !== 6) {
                showError('code-error', '6ìë¦¬ ì¸ì¦ ì½”ë“œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë¡œë”© ìƒíƒœ
            spinner.style.display = 'inline-block';
            btnText.textContent = 'í™•ì¸ ì¤‘...';

            // ê°€ì§œ ì¸ì¦ (ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ í™•ì¸)
            setTimeout(() => {
                if (code === '123456' || Math.random() > 0.3) { // 70% ì„±ê³µë¥ 
                    nextStep();
                } else {
                    showError('code-error', 'ì¸ì¦ ì½”ë“œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.');
                }
                
                // ë²„íŠ¼ ì›ë³µ
                spinner.style.display = 'none';
                btnText.textContent = 'ì¸ì¦ ì½”ë“œ í™•ì¸';
            }, 1500);
        }

        // 3ë‹¨ê³„: ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
        function resetPassword() {
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            const spinner = document.getElementById('step3-spinner');
            const btnText = document.getElementById('step3-text');

            // ìœ íš¨ì„± ê²€ì‚¬
            if (newPassword.length < 8) {
                showError('password-error', 'ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            if (newPassword !== confirmPassword) {
                showError('confirm-error', 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                return;
            }

            // ë¡œë”© ìƒíƒœ
            spinner.style.display = 'inline-block';
            btnText.textContent = 'ë³€ê²½ ì¤‘...';

            // ê°€ì§œ API í˜¸ì¶œ
            setTimeout(() => {
                alert('âœ… ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!\nìƒˆ ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
                window.location.href = 'page1_login.html';
            }, 1500);
        }

        // ë‹¨ê³„ ì´ë™
        function nextStep() {
            if (currentStep < totalSteps) {
                // í˜„ì¬ ë‹¨ê³„ ìˆ¨ê¸°ê¸°
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`step${currentStep}-indicator`).classList.remove('active');
                document.getElementById(`step${currentStep}-indicator`).classList.add('completed');
                
                // ë‹¤ìŒ ë‹¨ê³„ ë³´ì´ê¸°
                currentStep++;
                document.getElementById(`step${currentStep}`).classList.add('active');
                document.getElementById(`step${currentStep}-indicator`).classList.add('active');
                
                // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                const progress = (currentStep / totalSteps) * 100;
                document.getElementById('progress-fill').style.width = progress + '%';
            }
        }

        // ì¸ì¦ ì½”ë“œ ë‹¤ì‹œ ë³´ë‚´ê¸°
        function resendCode() {
            const btn = event.target;
            btn.disabled = true;
            btn.textContent = 'ì „ì†¡ ì¤‘...';
            
            setTimeout(() => {
                btn.textContent = 'ì½”ë“œë¥¼ ë‹¤ì‹œ ë³´ëƒˆìŠµë‹ˆë‹¤!';
                setTimeout(() => {
                    btn.disabled = false;
                    btn.textContent = 'ì½”ë“œ ë‹¤ì‹œ ë³´ë‚´ê¸°';
                }, 2000);
            }, 1000);
        }

        // ì…ë ¥ëœ ì¸ì¦ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
        function getEnteredCode() {
            let code = '';
            for (let i = 1; i <= 6; i++) {
                code += document.getElementById(`code${i}`).value;
            }
            return code;
        }

        // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
        function showError(elementId, message) {
            const errorElement = document.getElementById(elementId);
            errorElement.textContent = message;
            errorElement.className = 'validation-message error';
        }

        // ì¸ì¦ ì½”ë“œ ì…ë ¥ ìë™ ì´ë™
        document.querySelectorAll('.code-input').forEach((input, index) => {
            input.addEventListener('input', function(e) {
                if (this.value.length === 1 && index < 5) {
                    document.getElementById(`code${index + 2}`).focus();
                }
            });
            
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Backspace' && this.value === '' && index > 0) {
                    document.getElementById(`code${index}`).focus();
                }
            });
        });

        // ì´ë©”ì¼ ì…ë ¥ ì‹¤ì‹œê°„ ê²€ì¦
        document.getElementById('reset-email').addEventListener('input', function() {
            const emailError = document.getElementById('email-error');
            if (this.value && this.value.includes('@')) {
                this.classList.remove('error');
                this.classList.add('success');
                emailError.className = 'validation-message';
            } else if (this.value) {
                this.classList.add('error');
                this.classList.remove('success');
            }
        });

        // ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ì²´í¬
        document.getElementById('new-password').addEventListener('input', function() {
            const password = this.value;
            const strengthIndicator = document.getElementById('password-strength');
            const strengthFill = document.getElementById('strength-fill');
            const strengthText = document.getElementById('strength-text');
            
            if (password.length > 0) {
                strengthIndicator.style.display = 'block';
                
                let strength = 0;
                if (password.length >= 8) strength++;
                if (/[a-z]/.test(password)) strength++;
                if (/[A-Z]/.test(password)) strength++;
                if (/[0-9]/.test(password)) strength++;
                if (/[^a-zA-Z0-9]/.test(password)) strength++;
                
                let strengthClass = '';
                let strengthLabel = '';
                
                if (strength < 2) {
                    strengthClass = 'strength-weak';
                    strengthLabel = 'ì•½í•¨';
                    strengthFill.style.width = '20%';
                } else if (strength < 4) {
                    strengthClass = 'strength-medium';
                    strengthLabel = 'ë³´í†µ';
                    strengthFill.style.width = '60%';
                } else {
                    strengthClass = 'strength-strong';
                    strengthLabel = 'ê°•í•¨';
                    strengthFill.style.width = '100%';
                }
                
                strengthFill.className = `strength-fill ${strengthClass}`;
                strengthText.textContent = `ë¹„ë°€ë²ˆí˜¸ ê°•ë„: ${strengthLabel}`;
                strengthText.className = `strength-text ${strengthClass}`;
            } else {
                strengthIndicator.style.display = 'none';
            }
        });

        // ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì‹¤ì‹œê°„ ê²€ì¦
        document.getElementById('confirm-password').addEventListener('input', function() {
            const password = document.getElementById('new-password').value;
            const confirmError = document.getElementById('confirm-error');
            
            if (this.value && this.value === password) {
                this.classList.remove('error');
                this.classList.add('success');
                confirmError.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.';
                confirmError.className = 'validation-message success';
            } else if (this.value) {
                this.classList.add('error');
                this.classList.remove('success');
                confirmError.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                confirmError.className = 'validation-message error';
            }
        });

        // ì—”í„°í‚¤ ì²˜ë¦¬
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                if (currentStep === 1) {
                    sendResetCode();
                } else if (currentStep === 2) {
                    verifyCode();
                } else if (currentStep === 3) {
                    resetPassword();
                }
            }
        });
    </script>
</body>
</html>