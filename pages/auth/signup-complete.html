<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입 완료 - WorkSpace</title>
    
    <!-- CSS 파일들 임포트 -->
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/signup-complete.css">
</head>
<body>
    <!-- 배경 애니메이션 -->
    <div class="bg-animation">
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
    </div>

    <div class="complete-container">
        <!-- 성공 아이콘 -->
        <div class="success-icon">
            ✅
        </div>

        <!-- 메인 메시지 -->
        <h1 class="title">회원가입 완료!</h1>
        <p class="subtitle">
            환영합니다! 🎉<br>
            이메일 인증 코드를 입력해주세요.
        </p>

        <!-- 이메일 정보 -->
        <div class="email-info">
            <div class="email-icon">📧</div>
            <div class="email-title">인증 코드를 발송했습니다</div>
            <div class="email-address" id="user-email">user@example.com</div>
            <div class="email-note">
                위 이메일로 6자리 인증 코드를 보냈습니다.<br>
                코드를 입력해주세요.
            </div>
        </div>

        <!-- 인증 코드 입력 -->
        <div class="verification-section">
            <div class="verification-title">📱 인증 코드 입력</div>
            <div class="code-inputs">
                <input type="text" class="code-input" maxlength="1" id="code1">
                <input type="text" class="code-input" maxlength="1" id="code2">
                <input type="text" class="code-input" maxlength="1" id="code3">
                <input type="text" class="code-input" maxlength="1" id="code4">
                <input type="text" class="code-input" maxlength="1" id="code5">
                <input type="text" class="code-input" maxlength="1" id="code6">
            </div>
            <div class="validation-message" id="code-error"></div>
        </div>

        <!-- 액션 버튼들 -->
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="verifyCode()" id="verify-btn">
                <div class="loading-spinner" id="loading-spinner"></div>
                <span id="verify-text">인증 완료</span>
            </button>
            
            <button class="btn btn-secondary" id="resend-btn" onclick="resendEmail()">
                <span id="resend-text">코드 다시 보내기</span>
            </button>

            <div class="resend-timer" id="resend-timer" style="display: none;">
                재전송은 <span class="timer-text" id="timer-countdown">60</span>초 후 가능합니다
            </div>
        </div>

        <!-- 도움말 섹션 -->
        <div class="help-section">
            <div class="help-title">도움이 필요하세요?</div>
            <div class="help-links">
                <a href="#" class="help-link" onclick="showSupport()">고객 지원</a>
                <a href="#" class="help-link" onclick="changeEmail()">이메일 변경</a>
                <a href="#" class="help-link" onclick="goToLogin()">로그인 페이지</a>
            </div>
        </div>
    </div>

    <script>
        let resendTimer = 0;
        let timerInterval;

        // ============================
        // 초기화
        // ============================
        document.addEventListener('DOMContentLoaded', function() {
            const userEmail = 'user@example.com';
            document.getElementById('user-email').textContent = userEmail;
            setupCodeInputs();
        });

        // ============================
        // 인증 코드 입력 설정
        // ============================
        function setupCodeInputs() {
            const inputs = document.querySelectorAll('.code-input');
            
            inputs.forEach((input, index) => {
                input.addEventListener('input', function(e) {
                    // 숫자만 입력 허용
                    this.value = this.value.replace(/[^0-9]/g, '');
                    
                    // 다음 입력으로 자동 이동
                    if (this.value.length === 1 && index < inputs.length - 1) {
                        inputs[index + 1].focus();
                    }
                    
                    // 모든 코드 입력 시 자동 검증
                    checkAllInputsFilled();
                });
                
                input.addEventListener('keydown', function(e) {
                    // 백스페이스로 이전 입력으로 이동
                    if (e.key === 'Backspace' && this.value === '' && index > 0) {
                        inputs[index - 1].focus();
                    }
                    
                    // 엔터키로 인증
                    if (e.key === 'Enter') {
                        verifyCode();
                    }
                });
            });
        }

        function checkAllInputsFilled() {
            const inputs = document.querySelectorAll('.code-input');
            const allFilled = Array.from(inputs).every(input => input.value.length === 1);
            
            document.getElementById('verify-btn').disabled = !allFilled;
            
            return allFilled;
        }

        function getEnteredCode() {
            const inputs = document.querySelectorAll('.code-input');
            return Array.from(inputs).map(input => input.value).join('');
        }

        // ============================
        // 인증 코드 검증 (개발용)
        // ============================
        function verifyCode() {
            const code = getEnteredCode();
            const verifyBtn = document.getElementById('verify-btn');
            const verifyText = document.getElementById('verify-text');
            const spinner = document.getElementById('loading-spinner');
            const errorMsg = document.getElementById('code-error');
            
            if (code.length !== 6) {
                showError('6자리 인증 코드를 모두 입력해주세요.');
                return;
            }

            // 로딩 상태
            verifyBtn.disabled = true;
            verifyText.textContent = '인증 중...';
            spinner.style.display = 'inline-block';
            errorMsg.textContent = '';

            // 개발용: 간단한 검증 (123456 또는 임의 성공)
            setTimeout(() => {
                if (code === '123456' || Math.random() > 0.3) { // 70% 성공률
                    // 성공
                    verifyText.textContent = '인증 완료!';
                    spinner.style.display = 'none';
                    
                    setTimeout(() => {
                        alert('🎉 이메일 인증이 완료되었습니다!');
                        window.location.href = 'account-setup.html';
                    }, 500);
                } else {
                    // 실패
                    showError('인증 코드가 올바르지 않습니다. 다시 확인해주세요.');
                    
                    // 상태 원복
                    verifyBtn.disabled = false;
                    verifyText.textContent = '인증 완료';
                    spinner.style.display = 'none';
                    
                    // 입력 필드 초기화
                    clearCodeInputs();
                }
            }, 1500);
        }

        function showError(message) {
            const errorMsg = document.getElementById('code-error');
            errorMsg.textContent = message;
            errorMsg.style.color = '#ef4444';
            errorMsg.style.fontSize = '14px';
            errorMsg.style.marginTop = '8px';
        }

        function clearCodeInputs() {
            document.querySelectorAll('.code-input').forEach(input => {
                input.value = '';
            });
            document.querySelector('.code-input').focus();
        }

        // ============================
        // 이메일 재전송
        // ============================
        function resendEmail() {
            if (resendTimer > 0) {
                return;
            }

            const resendBtn = document.getElementById('resend-btn');
            const resendText = document.getElementById('resend-text');

            // 로딩 상태
            resendBtn.disabled = true;
            resendText.textContent = '전송 중...';

            setTimeout(() => {
                resendText.textContent = '코드를 다시 보냈습니다!';
                
                setTimeout(() => {
                    resendText.textContent = '코드 다시 보내기';
                    startResendTimer();
                }, 2000);
            }, 1500);
        }

        function startResendTimer() {
            resendTimer = 60;
            const resendBtn = document.getElementById('resend-btn');
            const timerElement = document.getElementById('resend-timer');
            const countdown = document.getElementById('timer-countdown');

            resendBtn.disabled = true;
            timerElement.style.display = 'block';

            timerInterval = setInterval(() => {
                resendTimer--;
                countdown.textContent = resendTimer;

                if (resendTimer <= 0) {
                    clearInterval(timerInterval);
                    resendBtn.disabled = false;
                    timerElement.style.display = 'none';
                }
            }, 1000);
        }

        // ============================
        // 기타 함수들
        // ============================
        function showSupport() {
            alert('📞 고객 지원\n\n이메일: support@workspace.com\n전화: 1588-1234\n운영시간: 평일 09:00-18:00');
        }

        function changeEmail() {
            const newEmail = prompt('새로운 이메일 주소를 입력하세요:');
            if (newEmail && newEmail.includes('@')) {
                if (confirm(`이메일을 ${newEmail}로 변경하시겠습니까?`)) {
                    document.getElementById('user-email').textContent = newEmail;
                    alert('✅ 이메일이 변경되었습니다.\n새로운 인증 코드를 발송했습니다.');
                    clearCodeInputs();
                }
            } else if (newEmail) {
                alert('올바른 이메일 주소를 입력해주세요.');
            }
        }

        function goToLogin() {
            if (confirm('로그인 페이지로 이동하시겠습니까?')) {
                window.location.href = 'login.html';
            }
        }

        // ============================
        // 초기 설정
        // ============================
        setTimeout(() => {
            startResendTimer();
        }, 1000);

        // ============================
        // 개발용 빠른 버튼
        // ============================
        document.body.insertAdjacentHTML('beforeend', `
            <button onclick="quickVerify()" style="position:fixed; top:10px; right:10px; z-index:9999; background:green; color:white; padding:10px; border:none; border-radius:5px; cursor:pointer;">
                빠른인증
            </button>
        `);

        function quickVerify() {
            // 123456 자동 입력
            const inputs = document.querySelectorAll('.code-input');
            '123456'.split('').forEach((digit, index) => {
                inputs[index].value = digit;
            });
            checkAllInputsFilled();
            
            setTimeout(() => {
                verifyCode();
            }, 500);
        }

        // 개발자 도구용
        window.debugVerify = {
            fillCode: (code = '123456') => {
                const inputs = document.querySelectorAll('.code-input');
                code.split('').forEach((digit, index) => {
                    if (inputs[index]) inputs[index].value = digit;
                });
                checkAllInputsFilled();
            },
            quickVerify: quickVerify
        };
        
        console.log('🔧 개발자 도구에서 debugVerify.fillCode() 또는 debugVerify.quickVerify()를 사용하여 테스트할 수 있습니다.');
    </script>

    <style>
        /* 인증 코드 입력 스타일 */
        .verification-section {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 24px;
            margin: 24px 0;
            text-align: center;
        }

        .verification-title {
            font-size: 16px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 16px;
        }

        .code-inputs {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 12px;
        }

        .code-input {
            width: 50px;
            height: 50px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            background: white;
            transition: border-color 0.2s;
        }

        .code-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .code-input:valid {
            border-color: #10b981;
        }

        @media (max-width: 480px) {
            .code-inputs {
                gap: 8px;
            }
            
            .code-input {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
        }
    </style>
</body>
</html>