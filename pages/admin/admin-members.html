<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ë¦¬ì í˜ì´ì§€ - íšŒì› ê´€ë¦¬ </title>
    
    <!-- CSS íŒŒì¼ë“¤ ì„í¬íŠ¸ -->
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/admin-members.css">
</head>
<body>
    <!-- ë°°ê²½ ì¥ì‹ -->
    <div class="bg-decoration"></div>
    <div class="bg-decoration"></div>
    <div class="bg-decoration"></div>

    <div class="admin-container">
        <!-- í—¤ë” -->
        <div class="header-section">
            <div class="admin-badge">ğŸ‘‘ ê´€ë¦¬ì</div>
            <div class="logo">ğŸŒŠ</div>
            <h1 class="welcome-text">ë©¤ë²„ ê´€ë¦¬</h1>
            <p class="subtitle">ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ë©¤ë²„ë“¤ì˜ ê°€ì… ìŠ¹ì¸ê³¼<br>ê¶Œí•œ ê´€ë¦¬ë¥¼ ìˆ˜í–‰í•˜ì„¸ìš”</p>
        </div>

        <!-- ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì •ë³´ -->
        <div class="workspace-info">
            <div class="workspace-icon">ğŸš€</div>
            <div class="workspace-details">
                <div class="workspace-name">ìŠ¤íƒ€íŠ¸ì—…íŒ€</div>
                <div class="workspace-meta">ì´ 24ëª…ì˜ ë©¤ë²„ â€¢ 3ëª… ìŠ¹ì¸ ëŒ€ê¸° ì¤‘</div>
            </div>
        </div>

        <!-- í†µê³„ ì„¹ì…˜ -->
        <div class="stats-section">
            <div class="section-title">
                ğŸ“Š ë©¤ë²„ í˜„í™©
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #0ea5e9, #2563eb);">ğŸ‘¥</div>
                    <div class="stat-number">24</div>
                    <div class="stat-label">ì „ì²´ ë©¤ë²„</div>
                    <div class="stat-change positive">+3 ì´ë²ˆ ì£¼</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">â³</div>
                    <div class="stat-number">3</div>
                    <div class="stat-label">ìŠ¹ì¸ ëŒ€ê¸°</div>
                    <div class="stat-change neutral">ìƒˆ ìš”ì²­</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">âœ…</div>
                    <div class="stat-number">21</div>
                    <div class="stat-label">í™œì„± ë©¤ë²„</div>
                    <div class="stat-change positive">87.5%</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">ğŸš«</div>
                    <div class="stat-number">0</div>
                    <div class="stat-label">ì •ì§€ëœ ë©¤ë²„</div>
                    <div class="stat-change neutral">ë³€í™” ì—†ìŒ</div>
                </div>
            </div>
        </div>

        <!-- íƒ­ ì„¹ì…˜ -->
        <div class="tab-section">
            <div class="tab-buttons">
                <button class="tab-button" onclick="switchTab('pending')" id="pending-tab">
                    ìŠ¹ì¸ ëŒ€ê¸°
                    <span class="tab-badge">3</span>
                </button>
                <button class="tab-button active" onclick="switchTab('active')" id="active-tab">
                    í™œì„± ë©¤ë²„
                </button>
                <button class="tab-button" onclick="switchTab('suspended')" id="suspended-tab">
                    ì •ì§€ëœ ë©¤ë²„
                </button>
            </div>

            <!-- ìŠ¹ì¸ ëŒ€ê¸° íƒ­ -->
            <div class="tab-content" id="pending-content">
                <div class="content-header">
                    <input type="text" class="search-input" placeholder="ì´ë¦„, ì´ë©”ì¼ë¡œ ê²€ìƒ‰..." id="pending-search">
                    <select class="filter-select" id="pending-filter">
                        <option value="all">ëª¨ë“  ìš”ì²­</option>
                        <option value="recent">ìµœê·¼ ìš”ì²­</option>
                        <option value="old">ì˜¤ë˜ëœ ìš”ì²­</option>
                    </select>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="inviteMembers()">
                            â• ë©¤ë²„ ì´ˆëŒ€
                        </button>
                    </div>
                </div>

                <div class="members-grid" id="pending-list">
                    <!-- ìŠ¹ì¸ ëŒ€ê¸° ë©¤ë²„ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- í™œì„± ë©¤ë²„ íƒ­ -->
            <div class="tab-content active" id="active-content">
                <div class="content-header">
                    <input type="text" class="search-input" placeholder="ì´ë¦„, ì´ë©”ì¼ë¡œ ê²€ìƒ‰..." id="active-search">
                    <select class="filter-select" id="active-filter">
                        <option value="all">ëª¨ë“  ë©¤ë²„</option>
                        <option value="admin">ê´€ë¦¬ì</option>
                        <option value="member">ì¼ë°˜ ë©¤ë²„</option>
                        <option value="contractor">ê³„ì•½ì§</option>
                    </select>
                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="exportMembers()">
                            ğŸ“¤ ë‚´ë³´ë‚´ê¸°
                        </button>
                        <button class="btn btn-primary" onclick="inviteMembers()">
                            â• ë©¤ë²„ ì´ˆëŒ€
                        </button>
                    </div>
                </div>

                <div class="members-grid" id="active-list">
                    <!-- í™œì„± ë©¤ë²„ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì •ì§€ëœ ë©¤ë²„ íƒ­ -->
            <div class="tab-content" id="suspended-content">
                <div class="empty-state">
                    <div class="empty-icon">ğŸš«</div>
                    <div class="empty-title">ì •ì§€ëœ ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤</div>
                    <div class="empty-description">í˜„ì¬ ì •ì§€ëœ ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤.<br>í•„ìš”ì‹œ ë©¤ë²„ ê´€ë¦¬ì—ì„œ ì •ì§€ ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- í™•ì¸ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="confirm-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-icon" id="modal-icon">âš ï¸</div>
                <div class="modal-title" id="modal-title">ì‘ì—… í™•ì¸</div>
                <div class="modal-description" id="modal-description">ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" id="confirm-btn" onclick="confirmAction()">
                    <div class="loading-spinner" id="modal-spinner"></div>
                    <span id="confirm-text">í™•ì¸</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============================
        // API ì„¤ì •
        // ============================
        const API_BASE_URL = 'http://localhost:8000';
        let currentAction = null;
        let targetMember = null;

        // ============================
        // ì´ˆê¸°í™” ë° ë°ì´í„° ë¡œë“œ
        // ============================
        document.addEventListener('DOMContentLoaded', function() {
            loadPendingMembers();
            loadActiveMembers();
            setupSearch();
        });

        // ìŠ¹ì¸ ëŒ€ê¸° ë©¤ë²„ ë¡œë“œ
        async function loadPendingMembers() {
            const mockPendingMembers = [
                {
                    id: 1,
                    name: 'ê¹€ì‹ ì…',
                    email: 'newbie@example.com',
                    role: 'ì‚¬ì›',
                    requestDate: '2024-01-15',
                    inviteCode: 'ABC123',
                    isContractor: false
                },
                {
                    id: 2,
                    name: 'ì´ê³„ì•½',
                    email: 'contractor@example.com',
                    role: 'ëŒ€ë¦¬',
                    requestDate: '2024-01-14',
                    inviteCode: 'XYZ789',
                    isContractor: true,
                    contractPeriod: '2024-01-15 ~ 2024-06-30'
                },
                {
                    id: 3,
                    name: 'ë°•ì§€ì›',
                    email: 'support@example.com',
                    role: 'ì‚¬ì›',
                    requestDate: '2024-01-13',
                    inviteCode: 'DEF456',
                    isContractor: false
                }
            ];

            renderMemberCards('pending-list', mockPendingMembers, 'pending');
        }

        // í™œì„± ë©¤ë²„ ë¡œë“œ
        async function loadActiveMembers() {
            const mockActiveMembers = [
                {
                    id: 101,
                    name: 'ì •ê´€ë¦¬ì',
                    email: 'admin@example.com',
                    role: 'ì´ì‚¬',
                    joinDate: '2023-06-01',
                    lastActivity: 'ë°©ê¸ˆ ì „',
                    isAdmin: true,
                    isContractor: false
                },
                {
                    id: 102,
                    name: 'ê¹€ê°œë°œ',
                    email: 'dev@example.com',
                    role: 'ê³¼ì¥',
                    joinDate: '2023-08-15',
                    lastActivity: '1ì‹œê°„ ì „',
                    isAdmin: false,
                    isContractor: false
                },
                {
                    id: 103,
                    name: 'ì´ë””ìì¸',
                    email: 'design@example.com',
                    role: 'ëŒ€ë¦¬',
                    joinDate: '2023-10-01',
                    lastActivity: '3ì‹œê°„ ì „',
                    isAdmin: false,
                    isContractor: false
                },
                {
                    id: 104,
                    name: 'ë°•í”„ë¦¬ëœì„œ',
                    email: 'freelancer@example.com',
                    role: 'ì‚¬ì›',
                    joinDate: '2024-01-01',
                    lastActivity: '1ì¼ ì „',
                    isAdmin: false,
                    isContractor: true,
                    contractPeriod: '2024-01-01 ~ 2024-12-31'
                }
            ];

            renderMemberCards('active-list', mockActiveMembers, 'active');
        }

        // ë©¤ë²„ ì¹´ë“œ ë Œë”ë§
        function renderMemberCards(containerId, members, type) {
            const container = document.getElementById(containerId);
            
            if (members.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">${type === 'pending' ? 'â³' : 'ğŸ‘¥'}</div>
                        <div class="empty-title">${type === 'pending' ? 'ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤' : 'ë©¤ë²„ê°€ ì—†ìŠµë‹ˆë‹¤'}</div>
                        <div class="empty-description">
                            ${type === 'pending' ? 'ìƒˆë¡œìš´ ê°€ì… ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.' : 'ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ë©¤ë²„ë¥¼ ì´ˆëŒ€í•´ë³´ì„¸ìš”.'}
                        </div>
                    </div>
                `;
                return;
            }

            container.innerHTML = members.map(member => {
                const avatar = member.name.charAt(0);
                const statusBadge = getStatusBadge(member, type);
                const actions = getActionsForMember(member, type);
                const metaInfo = getMetaInfo(member, type);
                
                return `
                    <div class="member-card" data-member-id="${member.id}">
                        <div class="member-header">
                            <div class="member-avatar">${avatar}</div>
                            <div class="member-info">
                                <div class="member-name">${member.name}</div>
                                <div class="member-email">${member.email}</div>
                                <div class="member-status">${statusBadge}</div>
                            </div>
                        </div>
                        <div class="member-meta">
                            ${metaInfo}
                        </div>
                        <div class="member-actions">
                            ${actions}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ë©¤ë²„ ìƒíƒœ ë°°ì§€ ìƒì„±
        function getStatusBadge(member, type) {
            if (type === 'pending') {
                return '<span class="status-badge status-pending">â³ ìŠ¹ì¸ ëŒ€ê¸°</span>';
            } else if (type === 'active') {
                if (member.isAdmin) {
                    return '<span class="status-badge status-admin">ğŸ‘‘ ê´€ë¦¬ì</span>';
                } else {
                    return '<span class="status-badge status-active">âœ… í™œì„±</span>';
                }
            } else if (type === 'suspended') {
                return '<span class="status-badge status-suspended">ğŸš« ì •ì§€</span>';
            }
            return '';
        }

        // ë©”íƒ€ ì •ë³´ ìƒì„±
        function getMetaInfo(member, type) {
            const metaItems = [];
            
            metaItems.push(`
                <div class="meta-row">
                    <span class="meta-label">ì§ê¸‰</span>
                    <span class="meta-value">ğŸ·ï¸ ${member.role}</span>
                </div>
            `);

            if (member.isContractor) {
                metaItems.push(`
                    <div class="meta-row">
                        <span class="meta-label">ê³ ìš©í˜•íƒœ</span>
                        <span class="meta-value">ğŸ¤ ê³„ì•½ì§</span>
                    </div>
                `);
            }

            if (member.contractPeriod) {
                metaItems.push(`
                    <div class="meta-row">
                        <span class="meta-label">ê³„ì•½ê¸°ê°„</span>
                        <span class="meta-value">ğŸ“… ${member.contractPeriod}</span>
                    </div>
                `);
            }

            if (member.joinDate) {
                metaItems.push(`
                    <div class="meta-row">
                        <span class="meta-label">ê°€ì…ì¼</span>
                        <span class="meta-value">ğŸ“… ${member.joinDate}</span>
                    </div>
                `);
            }

            if (member.requestDate) {
                metaItems.push(`
                    <div class="meta-row">
                        <span class="meta-label">ìš”ì²­ì¼</span>
                        <span class="meta-value">ğŸ“… ${member.requestDate}</span>
                    </div>
                `);
            }

            if (member.lastActivity) {
                metaItems.push(`
                    <div class="meta-row">
                        <span class="meta-label">ë§ˆì§€ë§‰ í™œë™</span>
                        <span class="meta-value">ğŸ•’ ${member.lastActivity}</span>
                    </div>
                `);
            }

            if (member.inviteCode) {
                metaItems.push(`
                    <div class="meta-row">
                        <span class="meta-label">ì´ˆëŒ€ ì½”ë“œ</span>
                        <span class="meta-value">ğŸ”— ${member.inviteCode}</span>
                    </div>
                `);
            }

            return metaItems.join('');
        }

        // ë©¤ë²„ë³„ ì•¡ì…˜ ë²„íŠ¼ ìƒì„±
        function getActionsForMember(member, type) {
            if (type === 'pending') {
                return `
                    <button class="action-btn action-approve" onclick="approveMember(${member.id}, '${member.name}')">
                        âœ… ìŠ¹ì¸
                    </button>
                    <button class="action-btn action-reject" onclick="rejectMember(${member.id}, '${member.name}')">
                        âŒ ê±°ë¶€
                    </button>
                `;
            } else if (type === 'active') {
                const actions = [
                    `<button class="action-btn action-edit" onclick="editMember(${member.id}, '${member.name}')">
                        âœï¸ í¸ì§‘
                    </button>`
                ];

                if (!member.isAdmin) {
                    actions.push(`
                        <button class="action-btn action-suspend" onclick="suspendMember(${member.id}, '${member.name}')">
                            ğŸš« ì •ì§€
                        </button>
                    `);
                }

                return actions.join('');
            }
            return '';
        }

        // ============================
        // íƒ­ ì „í™˜
        // ============================
        function switchTab(tabName) {
            // íƒ­ ë²„íŠ¼ í™œì„±í™”
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`${tabName}-tab`).classList.add('active');

            // íƒ­ ì½˜í…ì¸  ì „í™˜
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tabName}-content`).classList.add('active');
        }

        // ============================
        // ë©¤ë²„ ì•¡ì…˜ í•¨ìˆ˜ë“¤
        // ============================
        
        // ë©¤ë²„ ìŠ¹ì¸
        async function approveMember(memberId, memberName) {
            currentAction = 'approve';
            targetMember = { id: memberId, name: memberName };
            
            showModal(
                'âœ…',
                'ë©¤ë²„ ìŠ¹ì¸',
                `${memberName}ë‹˜ì˜ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ê°€ì…ì„ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nìŠ¹ì¸ í›„ ë°”ë¡œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ì°¸ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`,
                'ìŠ¹ì¸í•˜ê¸°'
            );
        }

        // ë©¤ë²„ ê±°ë¶€
        async function rejectMember(memberId, memberName) {
            currentAction = 'reject';
            targetMember = { id: memberId, name: memberName };
            
            showModal(
                'âŒ',
                'ê°€ì… ê±°ë¶€',
                `${memberName}ë‹˜ì˜ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ê°€ì… ìš”ì²­ì„ ê±°ë¶€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,
                'ê±°ë¶€í•˜ê¸°'
            );
        }

        // ë©¤ë²„ í¸ì§‘
        function editMember(memberId, memberName) {
            alert(`âœï¸ ${memberName}ë‹˜ì˜ ì •ë³´ í¸ì§‘ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.`);
        }

        // ë©¤ë²„ ì •ì§€
        async function suspendMember(memberId, memberName) {
            currentAction = 'suspend';
            targetMember = { id: memberId, name: memberName };
            
            showModal(
                'ğŸš«',
                'ë©¤ë²„ ì •ì§€',
                `${memberName}ë‹˜ì„ ì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì •ì§€ëœ ë©¤ë²„ëŠ” ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,
                'ì •ì§€í•˜ê¸°'
            );
        }

        // ============================
        // API í˜¸ì¶œ í•¨ìˆ˜ë“¤
        // ============================
        
        async function approveMemberAPI(memberId) {
            try {
                const token = localStorage.getItem('access_token');
                const response = await fetch(`${API_BASE_URL}/workspaces/1/approve/${memberId}`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    return { success: true };
                } else {
                    const data = await response.json();
                    return { success: false, error: data.detail || 'ìŠ¹ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' };
                }
            } catch (error) {
                return { success: false, error: 'ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' };
            }
        }

        async function rejectMemberAPI(memberId) {
            // ì‹¤ì œë¡œëŠ” ë³„ë„ì˜ ê±°ë¶€ APIê°€ í•„ìš”í•  ìˆ˜ ìˆìŒ
            try {
                return { success: true };
            } catch (error) {
                return { success: false, error: 'ê±°ë¶€ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' };
            }
        }

        // ============================
        // ëª¨ë‹¬ ê´€ë¦¬
        // ============================
        
        function showModal(icon, title, description, confirmText) {
            document.getElementById('modal-icon').textContent = icon;
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-description').textContent = description;
            document.getElementById('confirm-text').textContent = confirmText;
            document.getElementById('confirm-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('confirm-modal').style.display = 'none';
            currentAction = null;
            targetMember = null;
        }

        async function confirmAction() {
            if (!currentAction || !targetMember) return;

            const confirmBtn = document.getElementById('confirm-btn');
            const confirmText = document.getElementById('confirm-text');
            const spinner = document.getElementById('modal-spinner');

            // ë¡œë”© ìƒíƒœ
            confirmBtn.disabled = true;
            confirmText.textContent = 'ì²˜ë¦¬ ì¤‘...';
            spinner.style.display = 'inline-block';

            try {
                let result;
                
                switch (currentAction) {
                    case 'approve':
                        result = await approveMemberAPI(targetMember.id);
                        break;
                    case 'reject':
                        result = await rejectMemberAPI(targetMember.id);
                        break;
                    case 'suspend':
                        result = { success: true }; // ì„ì‹œ ì²˜ë¦¬
                        break;
                    default:
                        result = { success: false, error: 'ì•Œ ìˆ˜ ì—†ëŠ” ì‘ì—…ì…ë‹ˆë‹¤.' };
                }

                if (result.success) {
                    // ì„±ê³µ ì²˜ë¦¬
                    const actionNames = {
                        'approve': 'ìŠ¹ì¸',
                        'reject': 'ê±°ë¶€',
                        'suspend': 'ì •ì§€'
                    };
                    
                    const actionEmojis = {
                        'approve': 'âœ…',
                        'reject': 'âŒ',
                        'suspend': 'ğŸš«'
                    };
                    
                    alert(`${actionEmojis[currentAction]} ${targetMember.name}ë‹˜ì˜ ${actionNames[currentAction]}ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    
                    // í•´ë‹¹ ë©¤ë²„ ì¹´ë“œ ì œê±°
                    const memberCard = document.querySelector(`[data-member-id="${targetMember.id}"]`);
                    if (memberCard) {
                        memberCard.style.animation = 'fadeOut 0.3s ease-out forwards';
                        setTimeout(() => {
                            memberCard.remove();
                        }, 300);
                    }
                    
                    // í†µê³„ ì—…ë°ì´íŠ¸
                    updateStats(currentAction);
                    
                    closeModal();
                } else {
                    alert(`âŒ ì˜¤ë¥˜: ${result.error}`);
                }
            } catch (error) {
                alert('âŒ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                // ë¡œë”© ìƒíƒœ ì›ë³µ
                confirmBtn.disabled = false;
                confirmText.textContent = document.getElementById('confirm-text').textContent;
                spinner.style.display = 'none';
            }
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats(action) {
            if (action === 'approve') {
                // ìŠ¹ì¸ ëŒ€ê¸° -1, í™œì„± ë©¤ë²„ +1
                const pendingBadge = document.querySelector('#pending-tab .tab-badge');
                const currentPending = parseInt(pendingBadge.textContent) - 1;
                if (currentPending > 0) {
                    pendingBadge.textContent = currentPending;
                } else {
                    pendingBadge.remove();
                }
                
                // í†µê³„ ì¹´ë“œë„ ì—…ë°ì´íŠ¸
                const statCards = document.querySelectorAll('.stat-card');
                // ì „ì²´ ë©¤ë²„ ë³€í™” ì—†ìŒ (ì´ë¯¸ í¬í•¨ë¨)
                // ìŠ¹ì¸ ëŒ€ê¸° -1
                // í™œì„± ë©¤ë²„ +1
            }
        }

        // ============================
        // ì¶”ê°€ ê¸°ëŠ¥ë“¤
        // ============================
        
        function inviteMembers() {
            const inviteCode = Math.random().toString(36).substr(2, 6).toUpperCase();
            
            const message = `ğŸ‰ ìƒˆ ë©¤ë²„ ì´ˆëŒ€ ì½”ë“œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nğŸ”— ì´ˆëŒ€ ì½”ë“œ: ${inviteCode}\n\nì´ ì½”ë“œë¥¼ ìƒˆ ë©¤ë²„ì—ê²Œ ê³µìœ í•˜ì—¬ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ì´ˆëŒ€í•˜ì„¸ìš”.`;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(inviteCode).then(() => {
                    alert(message + '\n\nğŸ“‹ ì´ˆëŒ€ ì½”ë“œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.');
                });
            } else {
                alert(message);
            }
        }

        function exportMembers() {
            alert('ğŸ“¤ ë©¤ë²„ ëª©ë¡ ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ê²€ìƒ‰ ê¸°ëŠ¥
        function setupSearch() {
            const searchInputs = ['pending-search', 'active-search'];
            
            searchInputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (input) {
                    input.addEventListener('input', function() {
                        const searchTerm = this.value.toLowerCase();
                        const listType = inputId.split('-')[0];
                        const memberCards = document.querySelectorAll(`#${listType}-list .member-card`);
                        
                        memberCards.forEach(card => {
                            const name = card.querySelector('.member-name').textContent.toLowerCase();
                            const email = card.querySelector('.member-email').textContent.toLowerCase();
                            
                            if (name.includes(searchTerm) || email.includes(searchTerm)) {
                                card.style.display = 'block';
                            } else {
                                card.style.display = 'none';
                            }
                        });
                    });
                }
            });
        }

        // ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeOut {
                from {
                    opacity: 1;
                    transform: scale(1);
                }
                to {
                    opacity: 0;
                    transform: scale(0.9);
                }
            }
        `;
        document.head.appendChild(style);

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        document.getElementById('confirm-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // ê°œë°œì ë„êµ¬ìš© ë””ë²„ê¹…
        window.debugAdmin = {
            switchToTab: (tab) => switchTab(tab),
            simulateApproval: (memberId) => {
                const memberCard = document.querySelector(`[data-member-id="${memberId}"]`);
                if (memberCard) {
                    memberCard.remove();
                    updateStats('approve');
                }
                console.log(`ë©¤ë²„ ${memberId} ìŠ¹ì¸ì´ ì‹œë®¬ë ˆì´ì…˜ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            },
            addTestMember: () => {
                console.log('í…ŒìŠ¤íŠ¸ ë©¤ë²„ ì¶”ê°€ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
            }
        };
        
        console.log('ğŸ”§ ê°œë°œì ë„êµ¬ì—ì„œ debugAdmin ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
    </script>
</body>
</html>