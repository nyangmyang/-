<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì±„ë„ ê´€ë¦¬ - WorkSpace</title>
    
    <!-- CSS íŒŒì¼ë“¤ ì„í¬íŠ¸ -->
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/admin-channels.css">
</head>
<body>
    <!-- ë°°ê²½ ì¥ì‹ -->
    <div class="bg-decoration"></div>
    <div class="bg-decoration"></div>
    <div class="bg-decoration"></div>

    <div class="admin-container">
        <!-- í—¤ë” -->
        <div class="header-section">
            <div class="admin-badge">ğŸ‘‘ ê´€ë¦¬ì</div>
            <div class="logo">ğŸŒŠ</div>
            <h1 class="welcome-text">ì±„ë„ ê´€ë¦¬</h1>
            <p class="subtitle">ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì˜ ëª¨ë“  ì±„ë„ì„<br>ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”</p>
        </div>

        <!-- ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì •ë³´ -->
        <div class="workspace-info">
            <div class="workspace-icon">ğŸš€</div>
            <div class="workspace-details">
                <div class="workspace-name">ìŠ¤íƒ€íŠ¸ì—…íŒ€</div>
                <div class="workspace-meta">ì´ 8ê°œì˜ ì±„ë„ â€¢ 5ê°œ ê³µê°œ, 3ê°œ ë¹„ê³µê°œ</div>
            </div>
        </div>

        <!-- í†µê³„ ì„¹ì…˜ -->
        <div class="stats-section">
            <div class="section-title">
                ğŸ“Š ì±„ë„ í˜„í™©
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #0ea5e9, #2563eb);">ğŸ’¬</div>
                    <div class="stat-number">8</div>
                    <div class="stat-label">ì „ì²´ ì±„ë„</div>
                    <div class="stat-change positive">+2 ì´ë²ˆ ì£¼</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #10b981, #059669);">ğŸŒ</div>
                    <div class="stat-number">5</div>
                    <div class="stat-label">ê³µê°œ ì±„ë„</div>
                    <div class="stat-change positive">62.5%</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b, #d97706);">ğŸ”’</div>
                    <div class="stat-number">3</div>
                    <div class="stat-label">ë¹„ê³µê°œ ì±„ë„</div>
                    <div class="stat-change neutral">37.5%</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #6b7280, #4b5563);">ğŸ“¦</div>
                    <div class="stat-number">0</div>
                    <div class="stat-label">ë³´ê´€ëœ ì±„ë„</div>
                    <div class="stat-change neutral">ë³€í™” ì—†ìŒ</div>
                </div>
            </div>
        </div>

        <!-- ì±„ë„ ìƒì„± í¼ -->
        <div class="create-channel-form" id="create-form">
            <div class="form-header">
                <div class="form-title">ìƒˆ ì±„ë„ ë§Œë“¤ê¸°</div>
                <div class="form-description">ìƒˆë¡œìš´ ì±„ë„ì„ ìƒì„±í•˜ì—¬ íŒ€ ì†Œí†µì„ í™œì„±í™”í•˜ì„¸ìš”</div>
            </div>

            <div class="form-group">
                <label class="form-label" for="channel-name">
                    ì±„ë„ ì´ë¦„ <span style="color: #ef4444;">*</span>
                </label>
                <input 
                    type="text" 
                    id="channel-name" 
                    class="form-input" 
                    placeholder="ì˜ˆ: ì¼ë°˜, ê°œë°œíŒ€, í”„ë¡œì íŠ¸-A"
                    maxlength="50"
                >
            </div>

            <div class="form-group">
                <label class="form-label" for="channel-description">
                    ì±„ë„ ì„¤ëª…
                </label>
                <textarea 
                    id="channel-description" 
                    class="form-textarea" 
                    placeholder="ì±„ë„ì— ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                    maxlength="200"
                ></textarea>
            </div>

            <div class="form-checkbox-group">
                <input type="checkbox" id="is-private" class="form-checkbox">
                <label for="is-private" class="checkbox-label">
                    ğŸ”’ ë¹„ê³µê°œ ì±„ë„ (ì´ˆëŒ€ë°›ì€ ë©¤ë²„ë§Œ ì°¸ì—¬ ê°€ëŠ¥)
                </label>
            </div>

            <div class="form-actions">
                <button class="btn btn-secondary" onclick="cancelCreateChannel()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="createChannel()">
                    <div class="loading-spinner" id="create-spinner"></div>
                    <span id="create-btn-text">ì±„ë„ ë§Œë“¤ê¸°</span>
                </button>
            </div>
        </div>

        <!-- íƒ­ ì„¹ì…˜ -->
        <div class="tab-section">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="switchTab('active')" id="active-tab">
                    í™œì„± ì±„ë„
                </button>
                <button class="tab-button" onclick="switchTab('archived')" id="archived-tab">
                    ë³´ê´€ëœ ì±„ë„
                </button>
            </div>

            <!-- í™œì„± ì±„ë„ íƒ­ -->
            <div class="tab-content active" id="active-content">
                <div class="content-header">
                    <input type="text" class="search-input" placeholder="ì±„ë„ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰..." id="channel-search">
                    <select class="filter-select" id="channel-filter">
                        <option value="all">ëª¨ë“  ì±„ë„</option>
                        <option value="public">ê³µê°œ ì±„ë„</option>
                        <option value="private">ë¹„ê³µê°œ ì±„ë„</option>
                    </select>
                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="exportChannels()">
                            ğŸ“¤ ë‚´ë³´ë‚´ê¸°
                        </button>
                        <button class="btn btn-primary" onclick="showCreateForm()">
                            â• ì±„ë„ ë§Œë“¤ê¸°
                        </button>
                    </div>
                </div>

                <div class="channels-grid" id="channels-list">
                    <!-- ì±„ë„ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ë³´ê´€ëœ ì±„ë„ íƒ­ -->
            <div class="tab-content" id="archived-content">
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“¦</div>
                    <div class="empty-title">ë³´ê´€ëœ ì±„ë„ì´ ì—†ìŠµë‹ˆë‹¤</div>
                    <div class="empty-description">ë³´ê´€ëœ ì±„ë„ì´ ì—†ìŠµë‹ˆë‹¤.<br>í•„ìš”ì‹œ ì±„ë„ ê´€ë¦¬ì—ì„œ ì±„ë„ì„ ë³´ê´€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- í™•ì¸ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="confirm-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-icon" id="modal-icon">âš ï¸</div>
                <div class="modal-title" id="modal-title">ì‘ì—… í™•ì¸</div>
                <div class="modal-description" id="modal-description">ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" id="confirm-btn" onclick="confirmAction()">
                    <div class="loading-spinner" id="modal-spinner"></div>
                    <span id="confirm-text">í™•ì¸</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============================
        // API ì„¤ì •
        // ============================
        const API_BASE_URL = 'http://localhost:8000';
        let currentAction = null;
        let targetChannel = null;

        // ============================
        // ì´ˆê¸°í™” ë° ë°ì´í„° ë¡œë“œ
        // ============================
        document.addEventListener('DOMContentLoaded', function() {
            loadChannels();
            setupSearch();
        });

        // ì±„ë„ ëª©ë¡ ë¡œë“œ
        async function loadChannels() {
            const mockChannels = [
                {
                    id: 1,
                    name: 'ì „ì²´',
                    description: 'ëª¨ë“  íŒ€ì›ì´ ì°¸ì—¬í•˜ëŠ” ê³µê°œ ì±„ë„ì…ë‹ˆë‹¤.',
                    isPublic: true,
                    memberCount: 24,
                    messageCount: 1542,
                    createdAt: '2023-06-01',
                    lastActivity: 'ë°©ê¸ˆ ì „'
                },
                {
                    id: 2,
                    name: 'ê°œë°œíŒ€',
                    description: 'ê°œë°œ ê´€ë ¨ ë…¼ì˜ì™€ ì—…ë°ì´íŠ¸ë¥¼ ê³µìœ í•˜ëŠ” ì±„ë„ì…ë‹ˆë‹¤.',
                    isPublic: true,
                    memberCount: 8,
                    messageCount: 892,
                    createdAt: '2023-06-05',
                    lastActivity: '10ë¶„ ì „'
                },
                {
                    id: 3,
                    name: 'ë””ìì¸',
                    description: 'ë””ìì¸ ì‹œì•ˆê³¼ í”¼ë“œë°±ì„ ê³µìœ í•©ë‹ˆë‹¤.',
                    isPublic: false,
                    memberCount: 5,
                    messageCount: 234,
                    createdAt: '2023-07-15',
                    lastActivity: '1ì‹œê°„ ì „'
                },
                {
                    id: 4,
                    name: 'ë§ˆì¼€íŒ…',
                    description: 'ë§ˆì¼€íŒ… ì „ëµê³¼ ìº í˜ì¸ì„ ë…¼ì˜í•©ë‹ˆë‹¤.',
                    isPublic: true,
                    memberCount: 6,
                    messageCount: 567,
                    createdAt: '2023-08-01',
                    lastActivity: '3ì‹œê°„ ì „'
                },
                {
                    id: 5,
                    name: 'ìš´ì˜ì§„',
                    description: 'íšŒì‚¬ ìš´ì˜ê³¼ ê´€ë ¨ëœ ì¤‘ìš” ì‚¬í•­ì„ ë…¼ì˜í•©ë‹ˆë‹¤.',
                    isPublic: false,
                    memberCount: 4,
                    messageCount: 128,
                    createdAt: '2023-06-01',
                    lastActivity: '1ì¼ ì „'
                },
                {
                    id: 6,
                    name: 'ê³µì§€ì‚¬í•­',
                    description: 'ì¤‘ìš”í•œ ê³µì§€ì‚¬í•­ê³¼ ì—…ë°ì´íŠ¸ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.',
                    isPublic: true,
                    memberCount: 24,
                    messageCount: 89,
                    createdAt: '2023-06-01',
                    lastActivity: '2ì¼ ì „'
                },
                {
                    id: 7,
                    name: 'í”„ë¡œì íŠ¸-ì•ŒíŒŒ',
                    description: 'ì•ŒíŒŒ í”„ë¡œì íŠ¸ ì „ìš© ë¹„ê³µê°œ ì±„ë„ì…ë‹ˆë‹¤.',
                    isPublic: false,
                    memberCount: 7,
                    messageCount: 456,
                    createdAt: '2024-01-10',
                    lastActivity: '5ì‹œê°„ ì „'
                },
                {
                    id: 8,
                    name: 'ììœ ê²Œì‹œíŒ',
                    description: 'ììœ ë¡œìš´ ëŒ€í™”ì™€ ì¹œëª© ë„ëª¨ë¥¼ ìœ„í•œ ì±„ë„ì…ë‹ˆë‹¤.',
                    isPublic: true,
                    memberCount: 22,
                    messageCount: 1834,
                    createdAt: '2023-06-02',
                    lastActivity: '30ë¶„ ì „'
                }
            ];

            renderChannelCards(mockChannels);
        }

        // ì±„ë„ ì¹´ë“œ ë Œë”ë§
        function renderChannelCards(channels) {
            const container = document.getElementById('channels-list');
            
            if (channels.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ’¬</div>
                        <div class="empty-title">ì±„ë„ì´ ì—†ìŠµë‹ˆë‹¤</div>
                        <div class="empty-description">ìƒˆë¡œìš´ ì±„ë„ì„ ë§Œë“¤ì–´ íŒ€ ì†Œí†µì„ ì‹œì‘í•´ë³´ì„¸ìš”.</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = channels.map(channel => {
                const statusBadge = getChannelStatusBadge(channel);
                const actions = getChannelActions(channel);
                const metaInfo = getChannelMetaInfo(channel);
                
                return `
                    <div class="channel-card" data-channel-id="${channel.id}">
                        <div class="channel-header">
                            <div class="channel-icon ${channel.isPublic ? 'public' : 'private'}">
                                ${channel.isPublic ? '#' : 'ğŸ”’'}
                            </div>
                            <div class="channel-info">
                                <div class="channel-name">${channel.name}</div>
                                <div class="channel-description">${channel.description}</div>
                                <div class="channel-status">${statusBadge}</div>
                            </div>
                        </div>
                        <div class="channel-meta">
                            ${metaInfo}
                        </div>
                        <div class="channel-actions">
                            ${actions}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ì±„ë„ ìƒíƒœ ë°°ì§€ ìƒì„±
        function getChannelStatusBadge(channel) {
            if (channel.isPublic) {
                return '<span class="status-badge status-public">ğŸŒ ê³µê°œ ì±„ë„</span>';
            } else {
                return '<span class="status-badge status-private">ğŸ”’ ë¹„ê³µê°œ ì±„ë„</span>';
            }
        }

        // ì±„ë„ ë©”íƒ€ ì •ë³´ ìƒì„±
        function getChannelMetaInfo(channel) {
            const metaItems = [];
            
            metaItems.push(`
                <div class="meta-row">
                    <span class="meta-label">ë©¤ë²„ ìˆ˜</span>
                    <span class="meta-value">ğŸ‘¥ ${channel.memberCount}ëª…</span>
                </div>
            `);

            metaItems.push(`
                <div class="meta-row">
                    <span class="meta-label">ë©”ì‹œì§€ ìˆ˜</span>
                    <span class="meta-value">ğŸ’¬ ${channel.messageCount.toLocaleString()}ê°œ</span>
                </div>
            `);

            metaItems.push(`
                <div class="meta-row">
                    <span class="meta-label">ìƒì„±ì¼</span>
                    <span class="meta-value">ğŸ“… ${channel.createdAt}</span>
                </div>
            `);

            metaItems.push(`
                <div class="meta-row">
                    <span class="meta-label">ë§ˆì§€ë§‰ í™œë™</span>
                    <span class="meta-value">ğŸ•’ ${channel.lastActivity}</span>
                </div>
            `);

            return metaItems.join('');
        }

        // ì±„ë„ ì•¡ì…˜ ë²„íŠ¼ ìƒì„±
        function getChannelActions(channel) {
            const actions = [
                `<button class="action-btn action-edit" onclick="editChannel(${channel.id}, '${channel.name}')">
                    âœï¸ í¸ì§‘
                </button>`,
                `<button class="action-btn action-members" onclick="manageMembers(${channel.id}, '${channel.name}')">
                    ğŸ‘¥ ë©¤ë²„
                </button>`
            ];

            // ê¸°ë³¸ ì±„ë„(ì „ì²´, ê³µì§€ì‚¬í•­)ì´ ì•„ë‹Œ ê²½ìš° ë³´ê´€/ì‚­ì œ ê°€ëŠ¥
            if (channel.name !== 'ì „ì²´' && channel.name !== 'ê³µì§€ì‚¬í•­') {
                actions.push(`
                    <button class="action-btn action-archive" onclick="archiveChannel(${channel.id}, '${channel.name}')">
                        ğŸ“¦ ë³´ê´€
                    </button>
                `);
                
                actions.push(`
                    <button class="action-btn action-delete" onclick="deleteChannel(${channel.id}, '${channel.name}')">
                        ğŸ—‘ï¸ ì‚­ì œ
                    </button>
                `);
            }

            return actions.join('');
        }

        // ============================
        // íƒ­ ì „í™˜
        // ============================
        function switchTab(tabName) {
            // íƒ­ ë²„íŠ¼ í™œì„±í™”
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`${tabName}-tab`).classList.add('active');

            // íƒ­ ì½˜í…ì¸  ì „í™˜
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`${tabName}-content`).classList.add('active');
        }

        // ============================
        // ì±„ë„ ìƒì„±
        // ============================
        function showCreateForm() {
            const form = document.getElementById('create-form');
            form.classList.add('active');
            document.getElementById('channel-name').focus();
        }

        function cancelCreateChannel() {
            const form = document.getElementById('create-form');
            form.classList.remove('active');
            clearCreateForm();
        }

        function clearCreateForm() {
            document.getElementById('channel-name').value = '';
            document.getElementById('channel-description').value = '';
            document.getElementById('is-private').checked = false;
        }

        async function createChannel() {
            const name = document.getElementById('channel-name').value.trim();
            const description = document.getElementById('channel-description').value.trim();
            const isPrivate = document.getElementById('is-private').checked;
            
            if (!name) {
                alert('ì±„ë„ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const createBtn = event.target;
            const btnText = document.getElementById('create-btn-text');
            const spinner = document.getElementById('create-spinner');

            // ë¡œë”© ìƒíƒœ
            createBtn.disabled = true;
            btnText.textContent = 'ìƒì„± ì¤‘...';
            spinner.style.display = 'inline-block';

            try {
                // ì‹¤ì œ API í˜¸ì¶œ: POST /channels
                const result = await createChannelAPI(name, description, isPrivate);
                
                if (result.success) {
                    alert(`âœ… "${name}" ì±„ë„ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!`);
                    
                    // ì±„ë„ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                    await loadChannels();
                    
                    // í¼ ìˆ¨ê¸°ê¸°
                    cancelCreateChannel();
                } else {
                    alert(`âŒ ì˜¤ë¥˜: ${result.error}`);
                }
            } catch (error) {
                alert('âŒ ì±„ë„ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                // ë¡œë”© ìƒíƒœ ì›ë³µ
                createBtn.disabled = false;
                btnText.textContent = 'ì±„ë„ ë§Œë“¤ê¸°';
                spinner.style.display = 'none';
            }
        }

        async function createChannelAPI(name, description, isPrivate) {
            try {
                const token = localStorage.getItem('access_token');
                const response = await fetch(`${API_BASE_URL}/channels`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name: name,
                        workspace_id: 1, // ì‹¤ì œë¡œëŠ” í˜„ì¬ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ID
                        is_public: !isPrivate,
                        description: description
                    })
                });

                if (response.ok) {
                    return { success: true };
                } else {
                    const data = await response.json();
                    return { success: false, error: data.detail || 'ì±„ë„ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' };
                }
            } catch (error) {
                return { success: false, error: 'ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' };
            }
        }

        // ============================
        // ì±„ë„ ì•¡ì…˜ í•¨ìˆ˜ë“¤
        // ============================
        
        function editChannel(channelId, channelName) {
            alert(`âœï¸ "${channelName}" ì±„ë„ í¸ì§‘ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.`);
        }

        function manageMembers(channelId, channelName) {
            alert(`ğŸ‘¥ "${channelName}" ì±„ë„ ë©¤ë²„ ê´€ë¦¬ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.`);
        }

        async function archiveChannel(channelId, channelName) {
            currentAction = 'archive';
            targetChannel = { id: channelId, name: channelName };
            
            showModal(
                'ğŸ“¦',
                'ì±„ë„ ë³´ê´€',
                `"${channelName}" ì±„ë„ì„ ë³´ê´€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\në³´ê´€ëœ ì±„ë„ì€ ì½ê¸° ì „ìš©ì´ ë˜ë©°, ìƒˆ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`,
                'ë³´ê´€í•˜ê¸°'
            );
        }

        async function deleteChannel(channelId, channelName) {
            currentAction = 'delete';
            targetChannel = { id: channelId, name: channelName };
            
            showModal(
                'ğŸ—‘ï¸',
                'ì±„ë„ ì‚­ì œ',
                `"${channelName}" ì±„ë„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë©°, ëª¨ë“  ë©”ì‹œì§€ì™€ íŒŒì¼ì´ ì‚­ì œë©ë‹ˆë‹¤.`,
                'ì‚­ì œí•˜ê¸°'
            );
        }

        // ============================
        // ëª¨ë‹¬ ê´€ë¦¬
        // ============================
        
        function showModal(icon, title, description, confirmText) {
            document.getElementById('modal-icon').textContent = icon;
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-description').textContent = description;
            document.getElementById('confirm-text').textContent = confirmText;
            document.getElementById('confirm-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('confirm-modal').style.display = 'none';
            currentAction = null;
            targetChannel = null;
        }

        async function confirmAction() {
            if (!currentAction || !targetChannel) return;

            const confirmBtn = document.getElementById('confirm-btn');
            const confirmText = document.getElementById('confirm-text');
            const spinner = document.getElementById('modal-spinner');

            // ë¡œë”© ìƒíƒœ
            confirmBtn.disabled = true;
            confirmText.textContent = 'ì²˜ë¦¬ ì¤‘...';
            spinner.style.display = 'inline-block';

            try {
                let result;
                
                switch (currentAction) {
                    case 'archive':
                        result = { success: true }; // ì„ì‹œ ì²˜ë¦¬
                        break;
                    case 'delete':
                        result = { success: true }; // ì„ì‹œ ì²˜ë¦¬
                        break;
                    default:
                        result = { success: false, error: 'ì•Œ ìˆ˜ ì—†ëŠ” ì‘ì—…ì…ë‹ˆë‹¤.' };
                }

                if (result.success) {
                    // ì„±ê³µ ì²˜ë¦¬
                    const actionNames = {
                        'archive': 'ë³´ê´€',
                        'delete': 'ì‚­ì œ'
                    };
                    
                    const actionEmojis = {
                        'archive': 'ğŸ“¦',
                        'delete': 'ğŸ—‘ï¸'
                    };
                    
                    alert(`${actionEmojis[currentAction]} "${targetChannel.name}" ì±„ë„ì˜ ${actionNames[currentAction]}ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    
                    // í•´ë‹¹ ì±„ë„ ì¹´ë“œ ì œê±°
                    const channelCard = document.querySelector(`[data-channel-id="${targetChannel.id}"]`);
                    if (channelCard) {
                        channelCard.style.animation = 'fadeOut 0.3s ease-out forwards';
                        setTimeout(() => {
                            channelCard.remove();
                        }, 300);
                    }
                    
                    closeModal();
                } else {
                    alert(`âŒ ì˜¤ë¥˜: ${result.error}`);
                }
            } catch (error) {
                alert('âŒ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                // ë¡œë”© ìƒíƒœ ì›ë³µ
                confirmBtn.disabled = false;
                confirmText.textContent = document.getElementById('confirm-text').textContent;
                spinner.style.display = 'none';
            }
        }

        // ============================
        // ì¶”ê°€ ê¸°ëŠ¥ë“¤
        // ============================
        
        function exportChannels() {
            alert('ğŸ“¤ ì±„ë„ ëª©ë¡ ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ê²€ìƒ‰ ê¸°ëŠ¥
        function setupSearch() {
            const searchInput = document.getElementById('channel-search');
            const filterSelect = document.getElementById('channel-filter');
            
            if (searchInput) {
                searchInput.addEventListener('input', filterChannels);
            }
            
            if (filterSelect) {
                filterSelect.addEventListener('change', filterChannels);
            }
        }

        function filterChannels() {
            const searchTerm = document.getElementById('channel-search').value.toLowerCase();
            const filterType = document.getElementById('channel-filter').value;
            const channelCards = document.querySelectorAll('#channels-list .channel-card');
            
            channelCards.forEach(card => {
                const name = card.querySelector('.channel-name').textContent.toLowerCase();
                const description = card.querySelector('.channel-description').textContent.toLowerCase();
                const isPublic = card.querySelector('.channel-icon').classList.contains('public');
                
                let matchesSearch = name.includes(searchTerm) || description.includes(searchTerm);
                let matchesFilter = true;
                
                if (filterType === 'public') {
                    matchesFilter = isPublic;
                } else if (filterType === 'private') {
                    matchesFilter = !isPublic;
                }
                
                if (matchesSearch && matchesFilter) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        document.getElementById('confirm-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
                
                // ì±„ë„ ìƒì„± í¼ë„ ë‹«ê¸°
                const createForm = document.getElementById('create-form');
                if (createForm.classList.contains('active')) {
                    cancelCreateChannel();
                }
            }
        });

        // ì…ë ¥ í•„ë“œ ì‹¤ì‹œê°„ ê²€ì¦
        document.getElementById('channel-name').addEventListener('input', function() {
            const createBtn = document.querySelector('#create-form .btn-primary');
            createBtn.disabled = this.value.trim().length < 2;
        });

        // ê°œë°œì ë„êµ¬ìš© ë””ë²„ê¹…
        window.debugChannels = {
            showCreateForm: showCreateForm,
            loadChannels: loadChannels,
            switchToTab: (tab) => switchTab(tab),
            simulateChannelCreation: () => {
                document.getElementById('channel-name').value = 'í…ŒìŠ¤íŠ¸ ì±„ë„';
                document.getElementById('channel-description').value = 'í…ŒìŠ¤íŠ¸ìš© ì±„ë„ì…ë‹ˆë‹¤';
                console.log('í…ŒìŠ¤íŠ¸ ì±„ë„ ë°ì´í„°ê°€ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        };
        
        console.log('ğŸ”§ ê°œë°œì ë„êµ¬ì—ì„œ debugChannels ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        console.log('ì˜ˆ: debugChannels.showCreateForm(), debugChannels.simulateChannelCreation()');
    </script>
</body>
</html>